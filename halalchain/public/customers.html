<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Customer Portal - HalalChain</title>
    <link rel="stylesheet" href="/css/styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <!-- Navigation -->
    <nav class="main-nav" id="mainNav">
        <div class="nav-brand">
            <a href="/"><img src="/logo.png" alt="HalalChain Logo"></a>
        </div>
        
        <button class="menu-toggle" id="menuToggle">
            <i class="fas fa-bars"></i>
        </button>
        
        <div class="nav-links" id="navLinks">
            <a href="/marketplace.html"><i class="fas fa-store-alt"></i> Marketplace</a>
            <a href="/orders.html"><i class="fas fa-shopping-bag"></i> My Orders</a>
            <a href="/certifications.html"><i class="fas fa-certificate"></i> Certifications</a>
            <a href="/support.html"><i class="fas fa-headset"></i> Support</a>
        </div>
        
        <div class="auth-buttons">
            <button id="walletButton" class="wallet-btn"><i class="fas fa-wallet"></i> Connect Wallet</button>
            <div class="wallet-balance" id="walletBalance"></div>
        </div>
    </nav>

    <main class="customer-portal">
        <!-- Customer Dashboard -->
        <section class="customer-dashboard">
            <div class="dashboard-card">
                <h3><i class="fas fa-box-open"></i> Active Orders</h3>
                <div class="dashboard-value" id="activeOrders">0</div>
            </div>
            
            <div class="dashboard-card">
                <h3><i class="fas fa-coins"></i> Loyalty Points</h3>
                <div class="dashboard-value" id="loyaltyPoints">0 HC</div>
            </div>
            
            <div class="dashboard-card">
                <h3><i class="fas fa-certificate"></i> Certifications</h3>
                <div class="dashboard-value" id="certCount">0</div>
            </div>
        </section>

        <!-- Product Search -->
        <section class="product-search">
            <div class="search-container">
                <input type="text" placeholder="Search certified products..." id="productSearch">
                <button class="search-btn" onclick="searchProducts()">
                    <i class="fas fa-search"></i>
                </button>
            </div>
            <div class="search-filters">
                <select id="categoryFilter">
                    <option value="all">All Categories</option>
                    <option value="food">Food Products</option>
                    <option value="cosmetics">Cosmetics</option>
                    <option value="pharma">Pharmaceuticals</option>
                </select>
                <select id="certFilter">
                    <option value="all">All Certifications</option>
                    <option value="halal">Halal Certified</option>
                    <option value="organic">Organic Certified</option>
                </select>
            </div>
        </section>

        <!-- Certified Products Grid -->
        <section class="certified-products">
            <h2>Verified Products</h2>
            <div class="product-grid" id="productGrid">
                <!-- Dynamic content loaded from blockchain -->
                <div class="product-card">
                    <div class="cert-badge"><i class="fas fa-certificate"></i> HALAL</div>
                    <img src="/products/placeholder.jpg" alt="Product image">
                    <div class="product-info">
                        <h3>Product Name</h3>
                        <p class="product-desc">Product description</p>
                        <div class="product-meta">
                            <span class="price">$00.00</span>
                            <button class="buy-btn" onclick="handlePurchase()">
                                <i class="fas fa-cart-plus"></i> Buy Now
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Order History -->
        <section class="order-history">
            <h2><i class="fas fa-history"></i> Order History</h2>
            <div class="order-table">
                <table>
                    <thead>
                        <tr>
                            <th>Date</th>
                            <th>Product</th>
                            <th>Status</th>
                            <th>Amount</th>
                            <th>TX Hash</th>
                        </tr>
                    </thead>
                    <tbody id="orderHistory">
                        <!-- Dynamic content loaded from blockchain -->
                    </tbody>
                </table>
            </div>
        </section>
    </main>

    <!-- Footer -->
    <footer class="halal-footer">
        <!-- Same footer content as previous pages -->
    </footer>

    <!-- Scripts -->
    <script src="/js/main.js"></script>
    <script src="/js/customers.js"></script>
    <script>
        // Web3 initialization
        let web3;
        let contract;

        async function initWeb3() {
            if (typeof window.ethereum !== 'undefined') {
                web3 = new Web3(window.ethereum);
                try {
                    await window.ethereum.enable();
                    loadCustomerData();
                } catch (error) {
                    console.error("User denied account access");
                }
            }
        }

        async function loadCustomerData() {
            // Load orders, certifications, and loyalty points
            const account = await web3.eth.getAccounts();
            // Add blockchain calls here
        }

        function searchProducts() {
            // Implement search functionality
        }

        function handlePurchase() {
            // Implement purchase logic
        }

        document.addEventListener('DOMContentLoaded', initWeb3);
    </script>
</body>
</html>